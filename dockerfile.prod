### ğŸ§± Stage 1: Build the JAR using Gradle
FROM gradle:8.5-jdk21 AS builder

WORKDIR /app

# í•„ìš”í•œ íŒŒì¼ë§Œ ë¨¼ì € ë³µì‚¬í•´ì„œ ìºì‹œ ì‚¬ìš© ìµœì í™”
COPY build.gradle settings.gradle gradlew gradlew.bat /app/
COPY gradle /app/gradle

# dependencies ë¨¼ì € ë‹¤ìš´ë¡œë“œ (ìºì‹œ í™œìš© ëª©ì )
RUN ./gradlew dependencies

# ì „ì²´ ì†ŒìŠ¤ ë³µì‚¬
COPY . /app

# í”„ë¡œì íŠ¸ ë¹Œë“œ
RUN ./gradlew clean bootJar

### ğŸ³ Stage 2: Run the JAR
FROM eclipse-temurin:21-jdk-jammy

WORKDIR /app

# ë¹Œë“œ ê²°ê³¼ë¬¼ë§Œ ë³µì‚¬ (ê²½ëŸ‰ ì´ë¯¸ì§€)
COPY --from=builder /app/build/libs/*.jar app.jar

EXPOSE 8080

ENTRYPOINT ["java", "-jar", "app.jar"]
